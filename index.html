<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DebtFree Compass - Loan Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #10b981;
            --secondary-dark: #059669;
            --light: #f8fafc;
            --dark: #0f172a;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --danger: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;
            --border-radius: 12px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --box-shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px;
            width: 100%;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 0;
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            padding: 0 16px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            background: white;
            color: var(--primary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            flex-shrink: 0;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            white-space: nowrap;
        }

        /* Main App Styles */
        .app-view {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            margin: 20px 0;
            box-shadow: var(--box-shadow);
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            min-width: 100px;
            font-size: 0.9rem;
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--primary);
        }

        .tab:hover:not(.active) {
            background: var(--light-gray);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            margin-bottom: 25px;
            transition: var(--transition);
            box-sizing: border-box;
        }

        .card:hover {
            box-shadow: var(--box-shadow-lg);
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
            flex-wrap: wrap;
            gap: 10px;
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--dark);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }

        input, select {
            width: 100%;
            padding: 14px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            box-sizing: border-box;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .loans-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .loan-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: var(--transition);
            position: relative;
        }

        .loan-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .loan-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
        }

        .loan-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .loan-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            flex-wrap: wrap;
            gap: 5px;
        }

        .loan-body {
            padding: 20px;
        }

        .loan-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .stat {
            text-align: center;
            padding: 12px;
            background: var(--light);
            border-radius: 8px;
            transition: var(--transition);
        }

        .stat:hover {
            transform: scale(1.03);
            box-shadow: var(--box-shadow);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            text-transform: uppercase;
            margin-bottom: 6px;
        }

        .stat-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .progress-bar {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress {
            height: 100%;
            background: var(--secondary);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .loan-footer {
            display: flex;
            justify-content: space-between;
            padding: 0 20px 20px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            font-size: 0.9rem;
            white-space: nowrap;
            gap: 8px;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: var(--secondary-dark);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: rgba(37, 99, 235, 0.1);
        }

        .btn-danger {
            background: var(--danger);
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.875rem;
        }

        .chart-container {
            height: 200px;
            margin: 20px 0;
        }

        /* Privacy Policy */
        .privacy-container {
            max-width: 100%;
            margin: 20px 0;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 25px;
            box-sizing: border-box;
        }

        .privacy-container h1 {
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 1.8rem;
        }

        .privacy-container h2 {
            margin: 25px 0 15px;
            color: var(--primary);
            font-size: 1.4rem;
        }

        .privacy-container p {
            margin-bottom: 15px;
            line-height: 1.7;
            font-size: 1rem;
        }

        .privacy-container ul {
            margin: 15px 0 15px 25px;
        }

        .privacy-container li {
            margin-bottom: 10px;
            font-size: 1rem;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .footer-links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: white;
            text-decoration: none;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--secondary);
            text-decoration: underline;
        }

        /* Toast notifications */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-150%);
            padding: 16px 24px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-lg);
            color: var(--dark);
            font-weight: 600;
            z-index: 1000;
            transition: transform 0.3s ease;
            max-width: 90%;
            text-align: center;
            width: auto;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--danger);
        }

        .toast.info {
            border-left: 4px solid var(--primary);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 12px;
            }
            
            .loans-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
            }
            
            .loan-footer {
                flex-direction: column;
                gap: 8px;
            }
            
            .loan-footer .btn {
                width: 100%;
            }
            
            .footer-content {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }
            
            .footer-links {
                justify-content: center;
            }
            
            .payment-row {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .payment-input input {
                max-width: 100%;
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .loan-stats {
                grid-template-columns: 1fr;
            }
            
            .stat {
                text-align: left;
                display: flex;
                justify-content: space-between;
            }
            
            .privacy-container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Toast notifications -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span>Successfully added loan!</span>
    </div>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">DF</div>
                <div class="logo-text">DebtFree Compass</div>
            </div>
            <div class="user-info">
                <button id="resetBtn" class="btn btn-outline">
                    <i class="fas fa-sync-alt"></i>Reset All
                </button>
            </div>
        </div>
    </header>

    <!-- Main App View -->
    <div id="appView" class="app-view">
        <div class="container">
            <!-- Tab Navigation -->
            <div class="tabs">
                <div class="tab active" data-tab="loans">My Loans</div>
                <div class="tab" data-tab="payments">Payment History</div>
                <div class="tab" data-tab="privacy">Privacy Policy</div>
            </div>
            
            <!-- Tab Content -->
            <div id="loansTab" class="tab-content active">
                <!-- Add Loan Form -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Add New Loan</h2>
                    </div>
                    <form id="loanForm">
                        <div class="form-group">
                            <label for="loanName">Loan Name</label>
                            <input type="text" id="loanName" placeholder="e.g., Credit Card, Student Loan" required>
                        </div>
                        
                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label for="loanBalance">Current Balance ($)</label>
                                <input type="number" id="loanBalance" min="0" step="0.01" placeholder="5000" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="interestRate">Interest Rate (%)</label>
                                <input type="number" id="interestRate" min="0" step="0.01" placeholder="7.5" required>
                            </div>
                        </div>
                        
                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label for="minPayment">Minimum Payment ($)</label>
                                <input type="number" id="minPayment" min="0" step="0.01" placeholder="100" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="strategy">Payoff Strategy</label>
                                <select id="strategy">
                                    <option value="avalanche">Avalanche (Highest Interest First)</option>
                                    <option value="snowball">Snowball (Lowest Balance First)</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn">
                            <i class="fas fa-plus-circle"></i>Add Loan
                        </button>
                    </form>
                </div>
                
                <!-- Loans Dashboard -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Your Loans</h2>
                    </div>
                    
                    <div id="loansContainer" class="loans-grid">
                        <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                            <h3>Welcome to DebtFree Compass!</h3>
                            <p>Add your first loan to get started on your journey to financial freedom.</p>
                            <div style="margin-top: 20px; font-size: 4rem; color: var(--secondary);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Payment History Tab -->
            <div id="paymentsTab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Payment History</h2>
                    </div>
                    
                    <div id="historyContainer">
                        <div class="card" style="text-align: center; padding: 40px;">
                            <h3>No Payments Recorded Yet</h3>
                            <p>Make your first payment to see it appear here.</p>
                            <div style="margin-top: 20px; font-size: 4rem; color: var(--primary);">
                                <i class="fas fa-history"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Privacy Policy Tab -->
            <div id="privacyTab" class="tab-content">
                <div class="privacy-container">
                    <h1>Privacy Policy</h1>
                    <p>Last updated: August 14, 2025</p>
                    
                    <p>DebtFree Compass ("us", "we", or "our") operates the DebtFree Compass application. This page informs you of our policies regarding the collection, use, and disclosure of personal data when you use our Service and the choices you have associated with that data.</p>
                    
                    <h2>Information Collection and Use</h2>
                    <p>We collect several different types of information for various purposes to provide and improve our Service to you.</p>
                    
                    <h3>Types of Data Collected</h3>
                    <ul>
                        <li><strong>Financial Data:</strong> We collect information about your loans and payments that you voluntarily provide to use our Service.</li>
                        <li><strong>Usage Data:</strong> We may collect information on how the Service is accessed and used.</li>
                    </ul>
                    
                    <h2>Use of Data</h2>
                    <p>DebtFree Compass uses the collected data for various purposes:</p>
                    <ul>
                        <li>To provide and maintain our Service</li>
                        <li>To allow you to participate in interactive features of our Service</li>
                        <li>To provide customer support</li>
                        <li>To gather analysis to improve our Service</li>
                    </ul>
                    
                    <h2>Data Storage</h2>
                    <p>All data is stored locally in your browser. We do not collect or store any personal information on our servers.</p>
                    
                    <h2>Changes to This Privacy Policy</h2>
                    <p>We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page.</p>
                    
                    <h2>Contact Us</h2>
                    <p>If you have any questions about this Privacy Policy, please contact us at privacy@debtfreecompass.com</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="copyright">© 2025 DebtFree Compass. All rights reserved.</div>
                <div class="footer-links">
                    <a href="#" data-tab="privacy">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">Contact Us</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // App State
        const state = {
            loans: [],
            payments: []
        };

        // DOM Elements
        const elements = {
            appView: document.getElementById('appView'),
            loanForm: document.getElementById('loanForm'),
            loansContainer: document.getElementById('loansContainer'),
            resetBtn: document.getElementById('resetBtn'),
            historyContainer: document.getElementById('historyContainer'),
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            toast: document.getElementById('toast')
        };

        // Initialize the application
        function init() {
            setupEventListeners();
            loadData();
        }

        // Load data from localStorage
        function loadData() {
            const savedLoans = localStorage.getItem('loans');
            const savedPayments = localStorage.getItem('payments');
            
            if (savedLoans) {
                state.loans = JSON.parse(savedLoans);
            }
            
            if (savedPayments) {
                state.payments = JSON.parse(savedPayments);
            }
            
            if (state.loans.length > 0) {
                renderLoans();
            }
            
            if (state.payments.length > 0) {
                renderPaymentHistory();
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('loans', JSON.stringify(state.loans));
            localStorage.setItem('payments', JSON.stringify(state.payments));
        }

        // Setup event listeners
        function setupEventListeners() {
            // Loan form
            elements.loanForm.addEventListener('submit', (e) => {
                e.preventDefault();
                addLoan();
            });
            
            // Reset button
            elements.resetBtn.addEventListener('click', resetLoans);
            
            // Tab navigation
            elements.tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // Footer links
            document.querySelectorAll('.footer-links a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const tabId = link.getAttribute('data-tab');
                    if (tabId) {
                        switchTab(tabId);
                    }
                });
            });
        }

        // Add a new loan
        function addLoan() {
            const loan = {
                id: Date.now().toString(),
                name: elements.loanName.value,
                balance: parseFloat(elements.loanBalance.value),
                interestRate: parseFloat(elements.interestRate.value),
                minPayment: parseFloat(elements.minPayment.value),
                strategy: elements.strategy.value,
                payoffDate: calculatePayoffDate(
                    parseFloat(elements.loanBalance.value),
                    parseFloat(elements.interestRate.value),
                    parseFloat(elements.minPayment.value)
                ),
                totalInterest: 0,
                paid: 0
            };
            
            state.loans.push(loan);
            renderLoans();
            elements.loanForm.reset();
            saveData();
            
            showToast('Loan added successfully!', 'success');
        }

        // Calculate payoff date for a loan
        function calculatePayoffDate(balance, interestRate, minPayment) {
            // Simplified calculation for demo purposes
            const monthlyRate = interestRate / 100 / 12;
            let months = 0;
            let remaining = balance;
            
            while (remaining > 0) {
                months++;
                const interest = remaining * monthlyRate;
                const principalPayment = minPayment - interest;
                remaining -= principalPayment;
                
                if (remaining < 0) remaining = 0;
            }
            
            const payoffDate = new Date();
            payoffDate.setMonth(payoffDate.getMonth() + months);
            return payoffDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
        }

        // Render loans to the dashboard
        function renderLoans() {
            if (state.loans.length === 0) {
                elements.loansContainer.innerHTML = `
                    <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <h3>No Loans Added Yet</h3>
                        <p>Get started by adding your first loan using the form above.</p>
                        <div style="margin-top: 20px; font-size: 4rem; color: var(--secondary);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                `;
                return;
            }
            
            elements.loansContainer.innerHTML = '';
            
            state.loans.forEach(loan => {
                const paidAmount = 0;
                const paidPercentage = 0;
                
                const loanCard = document.createElement('div');
                loanCard.className = 'loan-card';
                loanCard.innerHTML = `
                    <div class="loan-header">
                        <div class="loan-name">${loan.name}</div>
                        <div class="loan-details">
                            <span>${loan.interestRate}% APR</span>
                            <span>Min: $${loan.minPayment.toFixed(2)}/mo</span>
                        </div>
                    </div>
                    <div class="loan-body">
                        <div class="loan-stats">
                            <div class="stat">
                                <div class="stat-label">Balance</div>
                                <div class="stat-value">$${loan.balance.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                            </div>
                            <div class="stat">
                                <div class="stat-label">Interest</div>
                                <div class="stat-value">$${loan.totalInterest.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}</div>
                            </div>
                            <div class="stat">
                                <div class="stat-label">Payoff Date</div>
                                <div class="stat-value">${loan.payoffDate}</div>
                            </div>
                            <div class="stat">
                                <div class="stat-label">Strategy</div>
                                <div class="stat-value">${loan.strategy === 'avalanche' ? 'Avalanche' : 'Snowball'}</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress" style="width: ${paidPercentage}%;"></div>
                        </div>
                        
                        <div class="payment-form">
                            <h4>Make a Payment</h4>
                            <div class="payment-row">
                                <div class="payment-input">
                                    <span>$</span>
                                    <input type="number" class="payment-amount" min="${loan.minPayment.toFixed(2)}" step="0.01" value="${loan.minPayment.toFixed(2)}">
                                </div>
                                <button class="btn btn-secondary btn-sm record-payment" data-id="${loan.id}">Record Payment</button>
                            </div>
                        </div>
                    </div>
                    <div class="loan-footer">
                        <button class="btn btn-sm btn-outline view-history" data-id="${loan.id}">View History</button>
                        <button class="btn btn-sm btn-danger remove-loan" data-id="${loan.id}">Remove</button>
                    </div>
                `;
                
                elements.loansContainer.appendChild(loanCard);
                
                // Add event listeners to buttons
                loanCard.querySelector('.record-payment').addEventListener('click', function() {
                    const loanId = this.getAttribute('data-id');
                    const amount = parseFloat(loanCard.querySelector('.payment-amount').value);
                    recordPayment(loanId, amount);
                });
                
                loanCard.querySelector('.remove-loan').addEventListener('click', function() {
                    const loanId = this.getAttribute('data-id');
                    removeLoan(loanId);
                });
                
                loanCard.querySelector('.view-history').addEventListener('click', function() {
                    const loanId = this.getAttribute('data-id');
                    showLoanHistory(loanId);
                });
            });
        }

        // Record a payment
        function recordPayment(loanId, amount) {
            const loan = state.loans.find(l => l.id === loanId);
            if (!loan) return;
            
            if (amount < loan.minPayment) {
                showToast(`Payment must be at least $${loan.minPayment.toFixed(2)}`, 'error');
                return;
            }
            
            const payment = {
                id: Date.now().toString(),
                loanId: loanId,
                loanName: loan.name,
                amount: amount,
                date: new Date().toLocaleDateString('en-US'),
                interest: amount * (loan.interestRate / 100 / 12),
                principal: amount - (amount * (loan.interestRate / 100 / 12))
            };
            
            state.payments.push(payment);
            renderPaymentHistory();
            saveData();
            
            showToast('Payment recorded!', 'success');
        }

        // Render payment history
        function renderPaymentHistory() {
            if (state.payments.length === 0) {
                elements.historyContainer.innerHTML = `
                    <div class="card" style="text-align: center; padding: 40px;">
                        <h3>No Payments Recorded Yet</h3>
                        <p>Make your first payment to see it appear here.</p>
                        <div style="margin-top: 20px; font-size: 4rem; color: var(--primary);">
                            <i class="fas fa-history"></i>
                        </div>
                    </div>
                `;
                return;
            }
            
            // Sort payments by date (newest first)
            const sortedPayments = [...state.payments].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = `
                <div class="card">
                    <h3>Payment History</h3>
                    <div style="overflow-x: auto;">
                        <table class="history-table" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background-color: var(--light);">
                                    <th style="padding: 12px; text-align: left;">Date</th>
                                    <th style="padding: 12px; text-align: left;">Loan</th>
                                    <th style="padding: 12px; text-align: right;">Amount</th>
                                    <th style="padding: 12px; text-align: right;">Principal</th>
                                    <th style="padding: 12px; text-align: right;">Interest</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            sortedPayments.forEach(payment => {
                html += `
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid var(--light-gray);">${payment.date}</td>
                        <td style="padding: 12px; border-bottom: 1px solid var(--light-gray);">${payment.loanName}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${payment.amount.toFixed(2)}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${payment.principal.toFixed(2)}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${payment.interest.toFixed(2)}</td>
                    </tr>
                `;
            });
            
            html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            elements.historyContainer.innerHTML = html;
        }

        // Show loan-specific payment history
        function showLoanHistory(loanId) {
            const loan = state.loans.find(l => l.id === loanId);
            if (!loan) return;
            
            const loanPayments = state.payments.filter(p => p.loanId === loanId);
            
            if (loanPayments.length === 0) {
                elements.historyContainer.innerHTML = `
                    <div class="card" style="text-align: center; padding: 40px;">
                        <h3>No Payments for ${loan.name}</h3>
                        <p>Make your first payment to see it appear here.</p>
                        <div style="margin-top: 20px; font-size: 4rem; color: var(--primary);">
                            <i class="fas fa-history"></i>
                        </div>
                    </div>
                `;
                return;
            }
            
            // Sort payments by date (newest first)
            const sortedPayments = [...loanPayments].sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = `
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 10px;">
                        <h3>Payment History: ${loan.name}</h3>
                        <button class="btn btn-sm btn-outline" id="backToAll">Back to All Payments</button>
                    </div>
                    <div style="overflow-x: auto;">
                        <table class="history-table" style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background-color: var(--light);">
                                    <th style="padding: 12px; text-align: left;">Date</th>
                                    <th style="padding: 12px; text-align: right;">Amount</th>
                                    <th style="padding: 12px; text-align: right;">Principal</th>
                                    <th style="padding: 12px; text-align: right;">Interest</th>
                                    <th style="padding: 12px; text-align: right;">Balance After</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            // Calculate running balance
            let runningBalance = loan.balance;
            
            sortedPayments.forEach(payment => {
                runningBalance -= payment.principal;
                
                html += `
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid var(--light-gray);">${payment.date}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${payment.amount.toFixed(2)}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${payment.principal.toFixed(2)}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${payment.interest.toFixed(2)}</td>
                        <td style="padding: 12px; text-align: right; border-bottom: 1px solid var(--light-gray);">$${runningBalance.toFixed(2)}</td>
                    </tr>
                `;
            });
            
            html += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            elements.historyContainer.innerHTML = html;
            
            // Add event listener to back button
            document.getElementById('backToAll').addEventListener('click', () => {
                renderPaymentHistory();
                switchTab('payments');
            });
            
            // Switch to payment history tab
            switchTab('payments');
        }

        // Remove a loan
        function removeLoan(loanId) {
            if (!confirm('Are you sure you want to remove this loan?')) return;
            
            // Remove loan
            state.loans = state.loans.filter(loan => loan.id !== loanId);
            
            // Remove related payments
            state.payments = state.payments.filter(payment => payment.loanId !== loanId);
            
            renderLoans();
            renderPaymentHistory();
            saveData();
            
            showToast('Loan removed successfully', 'success');
        }

        // Reset all loans
        function resetLoans() {
            if (!confirm('Are you sure you want to reset all loans?')) return;
            
            state.loans = [];
            state.payments = [];
            renderLoans();
            renderPaymentHistory();
            saveData();
            
            showToast('All loans have been reset', 'success');
        }

        // Switch tabs
        function switchTab(tabId) {
            // Update tab navigation
            elements.tabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                }
            });
            
            // Update tab content
            elements.tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId + 'Tab') {
                    content.classList.add('active');
                }
            });
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const icon = type === 'success' ? 'fa-check-circle' : 
                         type === 'error' ? 'fa-exclamation-circle' : 
                         'fa-info-circle';
            
            elements.toast.innerHTML = `<i class="fas ${icon}"></i><span>${message}</span>`;
            elements.toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                elements.toast.classList.remove('show');
            }, 3000);
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>